import{G as l}from"./lil-gui.esm-hsJpI9MV.js";import{B as g}from"./BaseDemo-CScLeyCm.js";import{S as d,E as m,B as w,N as u}from"./SunglassesFilter-CRddVk5Z.js";import{i as f}from"./flower-BOKp_aAz.js";class b{constructor(a){this.imageData=a}dye(){const{imageData:a}=this,t=a.data,s=t.length;for(let e=0;e<s-4;e+=4){const i=(t[e]+t[e+1]+t[e+2])/3;t[e]=i,t[e+1]=i,t[e+2]=i}return a}}class p{constructor(a){this.imageData=a}dye(){const{imageData:a}=this,t=a.data,s=t.length;for(let e=0;e<s-4;e+=4){const i=t[e],r=t[e+1],n=t[e+2];t[e]=Math.abs(r-n+r+i)*i/256,t[e+1]=Math.abs(n-r+n+i)*i/256,t[e+2]=Math.abs(n-r+n+i)*r/256}return a}}class h extends g{constructor(a){super(a),this.name="图像处理 —— 基础滤镜实现",this.config={scale:.2,resetScene:()=>this.drawScene(),filter:0},this.loadImage(f).then(t=>this.image=t).then(()=>{this.drawScene()}),this.createControl()}static init(a){return new h(a)}start(){return this}draw(){return this}createControl(){const{config:a}=this;this.gui=new l;const{gui:t}=this;return t.add(a,"scale").step(.01).min(.1).max(1).onChange(()=>this.drawScene()),t.add(a,"resetScene"),t.add(a,"filter",{default:0,Negative:1,BlackWhite:2,Embossment:3,Sunglasses:4,Grayscale:5,XXXFilter:6}).onFinishChange(s=>this.applyFilter(Number(s))),this}drawScene(){const{context:a,config:t,image:s}=this,e=this.width,i=this.height,r=s.width*t.scale/s.width,n=s.width*t.scale,c=s.height*r;return a.clearRect(0,0,this.canvas.width,this.canvas.height),a.drawImage(this.image,-n/2+e/2,-c/2+i/2,n,c),this}applyFilter(a){const{context:t}=this;this.drawScene();let s=null;const e=t.getImageData(this.canvas.width/2,0,this.canvas.width,this.canvas.height);switch(a){case 1:s=new u(e);break;case 2:s=new w(e);break;case 3:s=new m(e);break;case 4:s=new d(e);break;case 5:s=new b(e);break;case 6:s=new p(e);break;default:s=null}s&&s.dye(),t.putImageData(e,this.canvas.width/2,0)}}export{h as Demo};
