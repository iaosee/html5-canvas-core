var u=Object.defineProperty;var l=(r,n,t)=>n in r?u(r,n,{enumerable:!0,configurable:!0,writable:!0,value:t}):r[n]=t;var a=(r,n,t)=>l(r,typeof n!="symbol"?n+"":n,t);import{G as m}from"./lil-gui.esm-hsJpI9MV.js";import{B as v}from"./BaseDemo-DB1y7toB.js";import{R as f}from"./index-CnHRkG3L.js";class d extends v{constructor(t){super(t);a(this,"name","拖拽交互 —— 鼠标路径跟随");a(this,"lastTime",0);a(this,"circles",[]);a(this,"random",f.init(-5,5));a(this,"mousePosition",{x:this.centerX,y:this.centerY});a(this,"config",{quantity:50});this.canvas=t,this.centerX,this.centerY,this.createControl().drawGrid().createCircle(50).listenEvents()}static init(t){return new d(t)}draw(){return this.clearScreen().drawGrid().drawCircles().updateCircle()}createControl(){const{config:t}=this;this.gui=new m;const{gui:o}=this;return o.add(t,"quantity").min(5).max(300).step(5).onFinishChange(s=>{t.quantity=Number(s),this.createCircle(t.quantity,!0)}),this}createCircle(t=50,o=!1){o&&this.circles.splice(0,this.circles.length);for(let s=0;s<t;s++){const i=Math.random()*30,e={x:this.random.min(i).max(this.width-i).getOne(),y:this.random.min(i).max(this.height-i).getOne()};this.circles.push({position:e,velocityX:Math.random()*(this.random.range(-5,5).getOne()||5),velocityY:Math.random()*(this.random.range(-5,5).getOne()||5),radius:i,color:this.randomRgba()})}return this}drawCircles(){const{context:t,config:o}=this;return this.circles.forEach(s=>{t.beginPath(),t.arc(s.position.x,s.position.y,s.radius,0,Math.PI*2,!1),t.fillStyle=s.color,t.fill()}),this}updateCircle(){return this.circles.forEach(t=>this.updatePosition(t)),this}updatePosition(t){return(t.position.x+t.velocityX+t.radius>this.width||t.position.x+t.velocityX-t.radius<0)&&(t.velocityX=-t.velocityX),(t.position.y+t.velocityY+t.radius>this.height||t.position.y+t.velocityY-t.radius<0)&&(t.velocityY=-t.velocityY),t.position.x+=t.velocityX,t.position.y+=t.velocityY,this}moveFollow(){const{canvas:t,circles:o,mousePosition:s}=this;return o.forEach((i,e)=>{setTimeout(()=>{s.x>=this.width-i.radius||s.x<=i.radius?i.position.x=s.x<=i.radius?i.radius:this.width-i.radius:i.position.x=s.x,s.y>this.height-i.radius||s.y<=i.radius?i.position.y=s.y<=i.radius?i.radius:this.height-i.radius:i.position.y=s.y},e*10)}),this}animateFollw(){this.moveFollow(),this.clearScreen().drawGrid().drawCircles(),this.player=requestAnimationFrame(this.animateFollw.bind(this))}listenEvents(){const{canvas:t}=this,o=e=>{e.preventDefault(),this.stop(),this.animateFollw()},s=e=>{if(e.preventDefault(),console.log(e),e instanceof MouseEvent)this.mousePosition=this.coordinateTransformation(e.clientX,e.clientY);else if(e instanceof TouchEvent){const h=e.touches[0];this.mousePosition=this.coordinateTransformation(h.clientX,h.clientY)}},i=e=>{e.preventDefault(),this.start()};return t.addEventListener("mouseenter",o,!1),t.addEventListener("touchstart",o,!1),t.addEventListener("mousemove",s,!1),t.addEventListener("touchmove",s,!1),t.addEventListener("mouseleave",i,!1),t.addEventListener("touchend",i,!1),document.addEventListener("contextmenu",e=>e.preventDefault(),!1),this}}export{d as Demo};
