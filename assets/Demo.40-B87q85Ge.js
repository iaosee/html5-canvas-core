var d=Object.defineProperty;var m=(n,s,t)=>s in n?d(n,s,{enumerable:!0,configurable:!0,writable:!0,value:t}):n[s]=t;var h=(n,s,t)=>m(n,typeof s!="symbol"?s+"":s,t);import{G as w}from"./lil-gui.esm-hsJpI9MV.js";import{B as u}from"./BaseDemo-DB1y7toB.js";import{S as f,E as b,B as p,N as F}from"./SunglassesFilter-D7wnYvpw.js";import{i as S}from"./flower-BOKp_aAz.js";class v{constructor(s){h(this,"imageData");this.imageData=s}dye(){const{imageData:s}=this,t=s.data,i=t.length;for(let e=0;e<i-4;e+=4){const a=(t[e]+t[e+1]+t[e+2])/3;t[e]=a,t[e+1]=a,t[e+2]=a}return s}}class D{constructor(s){h(this,"imageData");this.imageData=s}dye(){const{imageData:s}=this,t=s.data,i=t.length;for(let e=0;e<i-4;e+=4){const a=t[e],r=t[e+1],c=t[e+2];t[e]=Math.abs(r-c+r+a)*a/256,t[e+1]=Math.abs(c-r+c+a)*a/256,t[e+2]=Math.abs(c-r+c+a)*r/256}return s}}class g extends u{constructor(t){super(t);h(this,"name","图像处理 —— 基础滤镜实现");h(this,"image");h(this,"config",{scale:.2,resetScene:()=>this.drawScene(),filter:0});this.canvas=t,this.loadImage(S).then(i=>this.image=i).then(()=>{this.drawScene()}),this.createControl()}static init(t){return new g(t)}start(){return this}draw(){return this}createControl(){const{config:t}=this;this.gui=new w;const{gui:i}=this;return i.add(t,"scale").step(.01).min(.1).max(1).onChange(()=>this.drawScene()),i.add(t,"resetScene"),i.add(t,"filter",{default:0,Negative:1,BlackWhite:2,Embossment:3,Sunglasses:4,Grayscale:5,XXXFilter:6}).onFinishChange(e=>this.applyFilter(Number(e))),this}drawScene(){const{context:t,config:i,image:e}=this,a=this.width,r=this.height,c=e.width*i.scale/e.width,o=e.width*i.scale,l=e.height*c;return t.clearRect(0,0,this.canvas.width,this.canvas.height),t.drawImage(this.image,-o/2+a/2,-l/2+r/2,o,l),this}applyFilter(t){const{context:i}=this;this.drawScene();let e=null;const a=i.getImageData(this.canvas.width/2,0,this.canvas.width,this.canvas.height);switch(t){case 1:e=new F(a);break;case 2:e=new p(a);break;case 3:e=new b(a);break;case 4:e=new f(a);break;case 5:e=new v(a);break;case 6:e=new D(a);break;default:e=null}e&&e.dye(),i.putImageData(a,this.canvas.width/2,0)}}export{g as Demo};
