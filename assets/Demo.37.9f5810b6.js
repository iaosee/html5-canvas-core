import{G as c}from"./lil-gui.esm.7a5dd4ff.js";import{B as l}from"./BaseDemo.deaf79c0.js";import{i as d}from"./flower.21c0439b.js";class o extends l{constructor(e){super(e),this.canvas=e,this.name="\u56FE\u50CF\u7F29\u653E",this.config={scale:1,minScale:.1,maxScale:5};const t=d;console.log(t),this.initOffScreenCanvas(),this.loadImage(t).then(i=>this.image=i).then(()=>{this.context.drawImage(this.image,0,0,this.width,this.height),this.offScreenContext.drawImage(this.image,0,0,this.width,this.height),this.drawWatermark(this.context),this.drawWatermark(this.offScreenContext)}),this.createControl().listenEvents()}static init(e){return new o(e)}start(){return this}draw(){return this}initOffScreenCanvas(){const{canvas:e}=this;this.offScreenCanvas=document.createElement("canvas"),this.offScreenContext=this.offScreenCanvas.getContext("2d"),this.offScreenCanvas.width=e.width,this.offScreenCanvas.height=e.height,this.offScreenContext.scale(this.dpr,this.dpr)}createControl(){const{config:e}=this;this.gui=new c;const{gui:t}=this;return t.add(e,"scale").min(e.minScale).max(e.maxScale).step(.01).onChange(()=>this.drawScene()),this}drawWatermark(e){const t="Copyright",i="iaosee, Inc.";let s=null;e.save(),e.fillStyle="rgba(1, 23, 27, 0.5)",e.strokeStyle="yellow",e.shadowColor="rgba(50, 50, 50, 1.0)",e.shadowOffsetX=5,e.shadowOffsetY=5,e.shadowBlur=10,e.font=100+"px Arial",s=e.measureText(t),e.translate(this.width/2,this.height-this.height/2),e.fillText(t,-s.width/2,0),e.strokeText(t,-s.width/2,0),s=e.measureText(i),e.fillText(i,-s.width/2,100),e.strokeText(i,-s.width/2,100),e.restore()}drawScene(){const{context:e,offScreenCanvas:t,canvas:i,config:a}=this,s=this.width,h=this.height,n=s*a.scale,r=h*a.scale;return e.clearRect(0,0,this.width,this.height),e.drawImage(t,0,0,t.width,t.height,-n/2+s/2,-r/2+h/2,n,r),this}listenEvents(){const{canvas:e}=this;return e.addEventListener("wheel",this.onWheelHandler.bind(this)),this}onWheelHandler(e){const{config:t}=this,i=-e.deltaY/1e3;console.log(t.scale),t.scale+=i,t.scale<=t.minScale?t.scale=t.minScale:t.scale>t.maxScale&&(t.scale=t.maxScale),this.drawScene()}}export{o as Demo};
