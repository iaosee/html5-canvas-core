import{G as n}from"./lil-gui.esm.7a5dd4ff.js";import{R as h}from"./Rubberband.c7ec187d.js";import"./BaseDemo.deaf79c0.js";class a extends h{constructor(e){super(e),this.canvas=e,this.name="\u526A\u8F91\u533A\u57DF-\u5B9E\u73B0\u6A61\u76AE\u6AAB",this.config={eraser:!1,eraserSize:20,fillStyle:[255,0,0,.8],eraserShape:"circle",ERASER_LINE_WIDTH:1,ERASER_SHADOW_COLOR:"rgb(0,0,0)",ERASER_SHADOW_STYLE:"blue",ERASER_STROKE_STYLE:"rgb(0,0,255)",ERASER_SHADOW_OFFSET:-5,ERASER_SHADOW_BLUR:20},this.createControl().listenEvents()}static init(e){return new a(e)}start(){return this.drawGrid().drawText()}draw(){return this}createControl(){const{config:e}=this;this.gui=new n;const{gui:t}=this;return t.add(e,"eraser"),t.add(e,"eraserShape",["circle","rect"]),t.add(e,"eraserSize").min(20).max(150).step(10),t.addColor(e,"fillStyle"),this}drawText(){const{context:e}=this;e.save(),e.shadowColor="rgba(100, 100, 150, 0.8)",e.shadowOffsetX=5,e.shadowOffsetY=5,e.shadowBlur=10,e.font="160px Palatino",e.fillStyle="cornflowerblue";const t="HTML5 Canvas \u{1F60B}",s=e.measureText(t);return e.fillText(t,this.centerX-s.width/2,this.centerY),e.strokeStyle="yellow",e.strokeText(t,this.centerX-s.width/2,this.centerY),e.restore(),this}drawRubberbandShape(e){const{context:t,config:s,mousedownPos:r,rubberbandRect:i}=this,o=Math.sqrt(Math.pow(i.width,2)+Math.pow(i.height,2));return t.fillStyle=this.rgbaFromArr(s.fillStyle)||this.randomRgba(),t.beginPath(),t.arc(r.x,r.y,o,0,Math.PI*2,!1),t.stroke(),t.fill(),this}eraseLast(){const{context:e}=this;return e.save(),this.setErasePathForEraser().clearScreen().drawGrid(),e.restore(),this}drawEraser(e){const{context:t}=this;return t.save(),this.setEraserAttributes(),this.setDrawPathForEraser(e),t.stroke(),t.restore(),this}setEraserAttributes(){const{context:e,config:t}=this;return e.lineWidth=t.ERASER_LINE_WIDTH,e.shadowColor=t.ERASER_SHADOW_STYLE,e.shadowOffsetX=t.ERASER_SHADOW_OFFSET,e.shadowOffsetY=t.ERASER_SHADOW_OFFSET,e.shadowBlur=t.ERASER_SHADOW_BLUR,e.strokeStyle=t.ERASER_STROKE_STYLE,this}setDrawPathForEraser(e){const{context:t,config:s}=this;return t.beginPath(),s.eraserShape==="circle"?t.arc(e.x,e.y,s.eraserSize/2,0,Math.PI*2,!1):t.rect(e.x-s.eraserSize/2,e.y-s.eraserSize/2,s.eraserSize,s.eraserSize),t.clip(),this}setErasePathForEraser(){const{context:e,config:t,mouseLastPos:s}=this;return e.beginPath(),t.eraserShape==="circle"?e.arc(s.x,s.y,t.eraserSize/2+t.ERASER_LINE_WIDTH,0,Math.PI*2,!1):e.rect(s.x-t.eraserSize/2-t.ERASER_LINE_WIDTH,s.y-t.eraserSize/2-t.ERASER_LINE_WIDTH,t.eraserSize+t.ERASER_LINE_WIDTH*2,t.eraserSize+t.ERASER_LINE_WIDTH*2),e.clip(),this}onMousedownHandler(e){const{context:t,config:s}=this;e.preventDefault(),s.eraser||this.saveDrawingSurface(),this.mousedownPos=this.coordinateTransformation(e.clientX,e.clientY),this.mouseLastPos=this.mousemovePos,this.dragging=!0}onMousemoveHandler(e){const{config:t}=this;!this.dragging||(e.preventDefault(),this.mousemovePos=this.coordinateTransformation(e.clientX,e.clientY),t.eraser?this.eraseLast().drawEraser(this.mousemovePos):(this.restoreDrawingSurface(),this.updateRubberband(this.mousemovePos),this.guidewires&&this.drawBandGuidelines()),this.mouseLastPos=this.mousemovePos)}onMouseupHandler(e){const{config:t}=this;!this.dragging||(e.preventDefault(),this.mousemovePos=this.coordinateTransformation(e.clientX,e.clientY),t.eraser&&this.eraseLast(),t.eraser||this.restoreDrawingSurface().updateRubberband(this.mousemovePos),this.dragging=!1)}}export{a as Demo};
