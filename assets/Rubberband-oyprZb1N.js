import{B as i,P as n}from"./BaseDemo-CScLeyCm.js";class o extends i{constructor(){super(...arguments),this.dragging=!1,this.guidewires=!0,this.mousedownPos=new n(0,0),this.mousemovePos=new n(0,0),this.rubberbandRect={width:0,height:0,x:0,y:0}}saveDrawingSurface(){const{canvas:e,context:t}=this;return this.drawingSurfaceImageData=t.getImageData(0,0,e.width,e.width),this}restoreDrawingSurface(){const{context:e}=this;return e.putImageData(this.drawingSurfaceImageData,0,0),this}updateRubberband(e){return this.updateRubberbandRectangle(e).drawRubberbandShape(e),this}updateRubberbandRectangle(e){const{rubberbandRect:t,mousedownPos:s}=this;return t.width=Math.abs(e.x-s.x),t.height=Math.abs(e.y-s.y),t.x=e.x>s.x?s.x:e.x,t.y=e.y>s.y?s.y:e.y,this}drawRubberbandShape(e){const{context:t,mousedownPos:s}=this;return t.save(),t.strokeStyle="blue",t.beginPath(),t.moveTo(s.x,s.y),t.lineTo(e.x,e.y),t.stroke(),t.closePath(),t.restore(),this}listenEvents(){const{canvas:e}=this;return e.addEventListener("mousedown",this.onMousedownHandler.bind(this)),e.addEventListener("mousemove",this.onMousemoveHandler.bind(this)),e.addEventListener("mouseup",this.onMouseupHandler.bind(this)),window.addEventListener("keydown",this.onKeydownHander.bind(this)),e.addEventListener("contextmenu",t=>t.preventDefault()),this}drawBandGuidelines(){const{context:e}=this;return this.drawGuidelines(this.mousedownPos.x,this.mousedownPos.y,"rgba(0,0,255,0.2)"),e.setLineDash([4,2]),this.drawGuidelines(this.mousemovePos.x,this.mousemovePos.y),e.setLineDash([]),this}onMousedownHandler(e){this.mousedownPos=this.coordinateTransformation(e.clientX,e.clientY),e.preventDefault(),this.saveDrawingSurface(),this.dragging=!0}onMousemoveHandler(e){this.dragging&&(e.preventDefault(),this.mousemovePos=this.coordinateTransformation(e.clientX,e.clientY),this.restoreDrawingSurface(),this.updateRubberband(this.mousemovePos),this.guidewires&&this.drawBandGuidelines())}onMouseupHandler(e){this.dragging&&(e.preventDefault(),this.mousemovePos=this.coordinateTransformation(e.clientX,e.clientY),this.restoreDrawingSurface(),this.updateRubberband(this.mousemovePos),this.dragging=!1)}onKeydownHander(e){e.key==="c"&&this.clearScreen().drawGrid()}}export{o as R};
